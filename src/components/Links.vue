<template>
  <div class="container" :style="{ fontSize }">
    <div class="left" ref="left" :style="{ marginLeft: overrideShift }">
      <svg
        viewBox="0 0 270 270"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        xml:space="preserve"
        xmlns:serif="http://www.serif.com/"
        style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"
      >
        <g transform="matrix(1,0,0,1,-6309.69,-2981.69)">
          <g transform="matrix(1,0,0,1,5958.49,2550.6)">
            <g transform="matrix(0.584276,0,0,0.584276,-2277.15,45.9338)">
              <path
                d="M4939.5,744.332C4939.5,708.62 4910.51,679.625 4874.79,679.625L4583.59,679.625C4547.88,679.625 4518.89,708.62 4518.89,744.332L4518.89,1035.53C4518.89,1071.25 4547.88,1100.24 4583.59,1100.24L4874.79,1100.24C4910.51,1100.24 4939.5,1071.25 4939.5,1035.53L4939.5,744.332Z"
                style="fill:white;fill-opacity:0.8;"
              />
              <path
                d="M4948.89,744.332C4949.67,723.611 4941.64,704.668 4928.53,690.595C4915.11,676.191 4896.01,667.348 4874.79,666.648C4874.79,666.648 4781.19,663.51 4700.07,662.469C4638.18,661.675 4583.59,662.265 4583.59,662.265C4560.99,662.408 4540.51,671.598 4525.8,686.539C4511.16,701.409 4502.11,721.837 4502.31,744.332C4502.31,744.332 4505.76,1035.53 4505.76,1035.53C4506.04,1056.92 4514.82,1076.24 4529.04,1090.09C4543.13,1103.82 4562.39,1112.32 4583.59,1112.04C4583.59,1112.04 4874.79,1108.68 4874.79,1108.68C4894.94,1108.58 4913.14,1100.31 4926.33,1087.07C4939.5,1073.84 4947.7,1055.65 4947.72,1035.53C4947.72,1035.53 4948.89,744.332 4948.89,744.332ZM4930.11,744.332L4931.29,1035.53C4931.29,1051.12 4925,1065.28 4914.75,1075.49C4904.52,1085.67 4890.36,1091.88 4874.79,1091.8C4874.79,1091.8 4583.59,1088.44 4583.59,1088.44C4569.08,1088.25 4556.05,1082.11 4546.66,1072.47C4537.38,1062.95 4531.82,1049.86 4532.01,1035.53C4532.01,1035.53 4535.46,744.332 4535.46,744.332C4535.58,731.113 4541.16,719.238 4549.9,710.634C4558.56,702.101 4570.48,696.902 4583.59,696.986C4583.59,696.986 4638.18,697.575 4700.07,696.781C4781.19,695.74 4874.79,692.603 4874.79,692.603C4889.31,692.124 4902.69,697.392 4912.55,706.578C4922.74,716.08 4929.54,729.318 4930.11,744.332Z"
              />
            </g>
          </g>
        </g>
      </svg>
      <div class="qr" ref="qr"></div>
    </div>
    <div class="right">
      <svg
        viewBox="0 0 270 270"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        xml:space="preserve"
        xmlns:serif="http://www.serif.com/"
        style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"
      >
        <g transform="matrix(1,0,0,1,-7257.68,-2981.69)">
          <g transform="matrix(1,0,0,1,5958.49,2550.6)">
            <g transform="matrix(0.584276,0,0,0.584276,-1329.16,45.9338)">
              <path
                d="M4939.5,744.332C4939.5,708.62 4910.51,679.625 4874.79,679.625L4583.59,679.625C4547.88,679.625 4518.89,708.62 4518.89,744.332L4518.89,1035.53C4518.89,1071.25 4547.88,1100.24 4583.59,1100.24L4874.79,1100.24C4910.51,1100.24 4939.5,1071.25 4939.5,1035.53L4939.5,744.332Z"
                style="fill:white;fill-opacity:0.8;"
              />
              <clipPath id="_clip1Links">
                <path
                  d="M4939.5,744.332C4939.5,708.62 4910.51,679.625 4874.79,679.625L4583.59,679.625C4547.88,679.625 4518.89,708.62 4518.89,744.332L4518.89,1035.53C4518.89,1071.25 4547.88,1100.24 4583.59,1100.24L4874.79,1100.24C4910.51,1100.24 4939.5,1071.25 4939.5,1035.53L4939.5,744.332Z"
                />
              </clipPath>
              <g clip-path="url(#_clip1Links)">
                <g transform="matrix(1.37285,0,0,1.37285,-1835.33,-193.713)">
                  <text
                    x="4678.74px"
                    y="687.823px"
                    style="font-family:'ComicNeue-Bold', 'Comic Neue';font-weight:700;font-size:29px;"
                  >
                    Visit the website:
                  </text>
                </g>
                <g transform="matrix(1.37285,0,0,1.37285,-1835.33,-23.1721)">
                  <text
                    x="4675.38px"
                    y="687.823px"
                    style="font-family:'ComicNeue-Bold', 'Comic Neue';font-weight:700;font-size:29px;"
                  >
                    &amp; Enter the code
                  </text>
                </g>
              </g>
              <path
                d="M4948.89,744.332C4948.55,723.999 4940.14,705.66 4926.58,692.544C4913.18,679.578 4894.89,671.589 4874.79,671.922C4874.79,671.922 4802,674.374 4729.19,673.518C4656.31,672.661 4583.59,668.495 4583.59,668.495C4562.5,668.005 4543.19,676.255 4529.14,689.881C4514.95,703.641 4506.35,723.025 4506.19,744.332C4506.19,744.332 4504.68,1035.53 4504.68,1035.53C4504.63,1057.33 4513.46,1077.08 4527.72,1091.41C4542,1105.76 4561.77,1114.64 4583.59,1114.69C4583.59,1114.69 4874.79,1114.2 4874.79,1114.2C4896.45,1114.02 4916.05,1105.19 4930.12,1090.86C4944.11,1076.61 4952.74,1057.05 4952.51,1035.53C4952.51,1035.53 4948.89,744.332 4948.89,744.332ZM4930.11,744.332L4926.49,1035.53C4926.34,1049.72 4920.36,1062.47 4910.96,1071.7C4901.65,1080.83 4888.85,1086.39 4874.79,1086.28C4874.79,1086.28 4583.59,1085.79 4583.59,1085.79C4569.71,1085.82 4557.11,1080.23 4547.98,1071.15C4538.83,1062.04 4533.12,1049.45 4533.09,1035.53C4533.09,1035.53 4531.58,744.332 4531.58,744.332C4531.47,729.926 4537.25,716.886 4546.55,707.292C4556,697.548 4568.97,691.095 4583.59,690.755C4583.59,690.755 4656.31,686.59 4729.19,685.733C4802,684.877 4874.79,687.329 4874.79,687.329C4890.41,687.588 4904.42,694.215 4914.5,704.629C4924.42,714.888 4930.36,728.949 4930.11,744.332Z"
              />
            </g>
          </g>
        </g>
      </svg>
      <div class="url">{{ url }}</div>
      <div class="code title-font">{{ code }}</div>
    </div>
  </div>
</template>

<script>
import { mapState } from "vuex";
import QRCode from "qrcode-svg";

export default {
  data() {
    return {
      fontSize: "20px",
    };
  },
  computed: {
    ...mapState(["stage", "code"]),
    qr_url: function() {
      return "https://venashial.games/delphi/remote/?join=" + this.code;
    },
    url: function() {
      if (this.stage.name == "New Room") {
        return "new.dphi.ml";
      } else {
        return "dphi.ml";
      }
    },
    overrideShift: function() {
      if (
        this.stage.overrides &&
        this.stage.overrides.includes("right_align_links")
      ) {
        return "45%";
      } else {
        return "0";
      }
    },
  },
  mounted() {
    this.fontSize = this.$refs.left.offsetWidth / 8 + "px";
    window.addEventListener("resize", () => {
      if (this.$refs.left) {
        this.fontSize = this.$refs.left.offsetWidth / 8 + "px";
      }
    });

    const svg = new QRCode({
      content: this.qr_url,
      padding: 0,
      width: 256,
      height: 256,
      color: "#000000",
      background: "rgba(0,0,0,0)",
      ecl: "L",
      join: true,
      container: "svg-viewbox",
    }).svg();
    this.$refs.qr.innerHTML = svg;
  },
};
</script>

<style scoped>
div.container {
  margin: auto;
  position: absolute;
  top: 0;
  bottom: 0; /* vertical center */
  left: 0;
  right: 0; /* horizontal center */

  width: 80%;
  height: auto;
  display: flex;
  justify-content: space-between;
  align-items: center;

  transform: translateY(0);

  pointer-events: none;
}

.url,
.code {
  position: absolute;
  width: 15%;
  text-align: center;
}

.url {
  margin-top: 5.3%;
  margin-left: 7.2%;
  text-decoration: underline;
  font-size: 85%;
}

.code {
  margin-top: 13.5%;
  margin-left: 7.5%;
  font-size: 130%;
}

.left,
.right {
  height: 30%;
  width: 30%;
}

.qr {
  position: absolute;
  margin-top: 3%;
  margin-left: 7.3%;
  width: 15.5%;
  height: 15.5%;
}

svg {
  position: absolute;
  height: 30%;
  width: 30%;
}
</style>

<style></style>
